1
2022-04-30 13:33:54.066592: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-04-30 13:33:54.066725: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Task is classification, not lift the flap.
Hard mining set to:both
Using materials: ['main_xml_50_lights_1']
Hotswapped material loader being used.
{1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12}
-------------------------------
Annotation Counts
-------------------------------
desk                       4829
trash_bin                  3204
chair                     19905
window                    10204
lamp                       2489
table                     11541
monitor                    3094
file_cabinet               1727
bookshelf                  3902
bed                        3214
sofa                       3550
bathtub                    1988
flowerpot                   227
Total                     69874
-------------------------------

annotations: ../openrooms/annotation_files/train_main_xml_50_lights_v3.json
batch_size: 15
checkpoint: null
git: e22ff54d4e15e859ff3672c5fc808cec0abfc80d
imagedir: ../
imbalance_reweighting: false
learning_rate: 1.0e-05
num_classes: 13
num_decoder_heads: 8
num_decoder_layers: 6
test_annotations: null
test_imagedir: null
uncertainty_gate_type: learned
uncertainty_threshold: 0.8
weighted_prediction: false

No checkpoint was passed.
Starting epoch: 1
batch num:0
overall: tensor(6.1296, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.7018, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.8193, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(6.4310, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.4359, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.2022, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.2859, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1214, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(7.0284, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.5955, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8312, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.4222, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8106, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1328, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1824, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.3606, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0763, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7191, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1147, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0872, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0075, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9941, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9661, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.7296, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.7161, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0470, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8354, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6788, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9512, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5814, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9530, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8388, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.3647, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5289, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0296, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5664, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7894, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.3618, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6896, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7295, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7565, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6908, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.9619, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.9689, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.4129, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6727, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2973, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6622, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.4623, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7112, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3334, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8455, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6071, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3586, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3896, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4260, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9978, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5583, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2015, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6902, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2159, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1889, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9009, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7785, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6632, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5841, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.9325, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7823, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8931, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5584, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1779, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2632, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.9978, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8669, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2329, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2453, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7311, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8737, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2492, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8875, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.0217, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4022, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5294, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1383, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6902, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8327, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5837, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4434, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4494, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2535, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.9862, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.7145, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.0419, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2810, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5639, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1755, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.1569, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.8833, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3081, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6899, device='cuda:0', grad_fn=<AddBackward0>)
batch num:100
overall: tensor(4.2293, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3576, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6135, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5496, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.0634, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(5.3283, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.3967, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1366, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.5620, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4402, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1572, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2909, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.9357, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1980, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.2913, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4710, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.7633, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(3.5273, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.6214, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.1835, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4642, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.4831, device='cuda:0', grad_fn=<AddBackward0>)
overall: tensor(4.8407, device='cuda:0', grad_fn=<AddBackward0>)
../openrooms/all_openrooms/main_xml_50_lights//scene0168_01/im_9.png
../openrooms/stylized_all_openrooms/main_xml_50_lights_1//scene0168_01/im_9.png
Traceback (most recent call last):
  File "train_hotswapped.py", line 173, in <module>
    for i, (context_images, target_images, context_images_2, target_images_2, bbox, labels_cpu) in enumerate(dataloader):
  File "/n/home05/smadan/.conda/envs/domain_adaptation/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/n/home05/smadan/.conda/envs/domain_adaptation/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/n/home05/smadan/.conda/envs/domain_adaptation/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/n/home05/smadan/.conda/envs/domain_adaptation/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/net/coxfs01/srv/export/coxfs01/pfister_lab2/share_root/Lab/spandan/contextual_domain_adaptation/WhenPigsFlyContext/core/dataset_hotswapped.py", line 123, in __getitem__
    image_2 = image_2.convert("RGB")
UnboundLocalError: local variable 'image_2' referenced before assignment
