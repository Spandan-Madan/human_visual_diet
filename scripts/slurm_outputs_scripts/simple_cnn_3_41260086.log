3
Warning: You are running the empty baseline, so network is being fed an input of just zeros.
annotations: ../openrooms/annotation_files/train_main_xml_50_lights_v3.json
batch_size: 50
checkpoint: checkpoint_20.tar
empty_baseline: false
git: e22ff54d4e15e859ff3672c5fc808cec0abfc80d
imagedir: ../
imbalance_reweighting: false
learning_rate: 1.0e-05
lift_the_flap: false
no_context: false
num_classes: 13
num_decoder_heads: 8
num_decoder_layers: 6
test_annotations: ../openrooms/annotation_files/scannet_handmade_test_set.json
test_imagedir: ../
uncertainty_gate_type: learned
uncertainty_threshold: 0.8
weighted_prediction: true

Initializing model from checkpoint checkpoint_20.tar
cfg is
annotations: ../openrooms/annotation_files/train_main_xml_50_lights_v3.json
batch_size: 50
checkpoint: checkpoint_20.tar
empty_baseline: false
git: e22ff54d4e15e859ff3672c5fc808cec0abfc80d
imagedir: ../
imbalance_reweighting: false
learning_rate: 1.0e-05
lift_the_flap: false
no_context: false
num_classes: 13
num_decoder_heads: 8
num_decoder_layers: 6
test_annotations: ../openrooms/annotation_files/scannet_handmade_test_set.json
test_imagedir: ../
uncertainty_gate_type: learned
uncertainty_threshold: 0.8
weighted_prediction: true

args is
Namespace(annotations='../openrooms/annotation_files/scannet_handmade_test_set.json', batch_size=50, checkpoint='v3_output/vit_light_transfer_scratch/checkpoint_20.tar', config='v3_output/vit_light_transfer_scratch/config.yaml', empty_baseline=False, imagedir='../', lift_the_flap=False, model_name='vit', no_context=False, outdir='v3_output/vit_light_transfer_scratch/', outname='scannet_handmade', print_batch_metrics=False, record_individual_scores=False, uncertainty_gate_type=None, uncertainty_threshold=None, weighted_prediction=True)
-------------------------------
Annotation Counts
-------------------------------
chair                       106
bed                           4
bookshelf                    13
sofa                        108
table                        58
monitor                      13
bathtub                       6
trash_bin                    10
lamp                          6
window                        1
desk                          1
file_cabinet                  1
Total                       327
-------------------------------

batch size is 50
Data Loader lenght is 7
Test Batches:   0%|          | 0/7 [00:00<?, ?it/s]Test Batches:  14%|█▍        | 1/7 [00:11<01:07, 11.33s/it]Test Batches:  29%|██▊       | 2/7 [00:11<00:23,  4.79s/it]Test Batches:  43%|████▎     | 3/7 [00:11<00:10,  2.70s/it]Test Batches:  57%|█████▋    | 4/7 [00:13<00:07,  2.40s/it]Test Batches:  71%|███████▏  | 5/7 [00:15<00:04,  2.25s/it]Test Batches:  86%|████████▌ | 6/7 [00:17<00:02,  2.15s/it]Test Batches: 100%|██████████| 7/7 [00:18<00:00,  1.78s/it]Test Batches: 100%|██████████| 7/7 [00:18<00:00,  2.67s/it]

Total Test Accuracy: 0.30720436573028564
Class                Accuracy  
table                    0.1897
desk                     1.0000
bookshelf                0.0000
sofa                     0.0648
trash_bin                0.2000
bed                      0.0000
chair                    0.4623
monitor                  0.0769
bathtub                  0.3333
file_cabinet             0.0000
flowerpot                0.0000
window                   1.0000
lamp                     0.6667
